#pragma once

#define LIST(...) {__VA_ARGS__}

// TEST_DATA(q_shape,
//           k_shape,
//           v_shape,
//           attention_mask_shape,
//           output_shape,
//           is_causal,
//           q_data,
//           k_data,
//           v_data,
//           attention_mask_data,
//           expected_output_data,
//           description)

// NOTE: expected output were generated using torch.nn.functional.scaled_dot_product_attention implementation.

TEST_DATA(LIST(1, 32, 8),
          LIST(1, 16, 8),
          LIST(1, 16, 4),
          LIST(),
          LIST(1, 32, 4),
          false,
          LIST(0.421005,
               0.023465,
               -0.394774,
               0.974785,
               0.512418,
               0.219203,
               -0.338684,
               1.122448,
               -0.128486,
               -0.484502,
               0.56865,
               1.332561,
               0.222876,
               0.093504,
               0.89355,
               -0.659941,
               1.187668,
               -2.086986,
               -0.42915,
               -0.198203,
               1.385841,
               0.052231,
               0.587976,
               -0.684267,
               -0.045731,
               0.629634,
               1.78197,
               -1.381788,
               0.812565,
               0.522027,
               0.013688,
               -0.070836,
               1.131118,
               0.147256,
               -0.452005,
               0.263287,
               0.489187,
               -0.710666,
               0.531863,
               -0.996062,
               0.188195,
               -0.022838,
               -0.961315,
               0.174546,
               -2.681746,
               -0.311997,
               -0.007598,
               0.152766,
               -0.700153,
               0.785022,
               0.449904,
               -0.437027,
               0.846442,
               -2.708081,
               -0.357738,
               1.859077,
               -1.122008,
               0.797016,
               -0.205318,
               0.620443,
               -1.210487,
               -0.100233,
               -0.644188,
               1.252426,
               -1.503346,
               1.685813,
               -0.655548,
               0.148169,
               0.98681,
               -1.806409,
               -0.789457,
               0.934387,
               0.819341,
               -0.359637,
               -0.394646,
               -0.040578,
               1.10817,
               1.745871,
               -0.706232,
               2.154361,
               -0.417549,
               0.724758,
               -1.090765,
               0.9193,
               0.535271,
               -0.979016,
               0.870831,
               -0.405604,
               -0.192899,
               0.242223,
               -2.103053,
               -0.234349,
               -1.273937,
               -0.334684,
               -1.239732,
               1.185672,
               1.292743,
               0.741054,
               -0.700485,
               -0.252933,
               -0.760226,
               0.68806,
               0.761746,
               0.065581,
               -0.189028,
               0.253604,
               0.17645,
               0.993091,
               0.771911,
               -0.45738,
               -0.123291,
               -0.150833,
               -1.207279,
               -1.033516,
               -0.975503,
               0.626698,
               0.50241,
               -1.377113,
               -0.788385,
               0.043618,
               -0.945737,
               0.093409,
               -0.43187,
               0.748239,
               1.084854,
               1.147015,
               0.171417,
               -0.231462,
               -1.082049,
               0.213656,
               -0.888956,
               0.489294,
               -0.722142,
               0.920915,
               -1.327819,
               -1.384117,
               -1.432893,
               -0.535934,
               0.48227,
               0.220006,
               -0.589304,
               -1.305996,
               -1.089244,
               1.762965,
               -1.320682,
               -0.014023,
               -0.26418,
               -1.665839,
               2.005492,
               0.566283,
               0.553813,
               -0.960131,
               -0.965173,
               -0.512779,
               0.814464,
               -0.662501,
               -2.681507,
               0.164813,
               -0.344629,
               -0.353064,
               0.869497,
               0.558342,
               0.504291,
               -0.331423,
               0.383466,
               -1.433365,
               -0.47628,
               0.703471,
               -0.851835,
               -1.458019,
               1.99797,
               1.234475,
               1.738404,
               -0.198748,
               0.229233,
               -0.468942,
               0.274935,
               -0.318531,
               0.395246,
               -0.463232,
               -0.0943,
               0.507692,
               -0.51417,
               -0.166324,
               -0.853083,
               0.096419,
               0.103585,
               -0.323117,
               -1.863742,
               -1.616867,
               -0.65718,
               2.499854,
               -0.282102,
               -0.990155,
               1.102401,
               1.342318,
               0.666025,
               -1.808015,
               0.555367,
               0.165921,
               -0.43009,
               -0.521742,
               0.994636,
               1.097344,
               0.381748,
               0.498743,
               0.057956,
               0.254353,
               -1.03177,
               0.13464,
               0.5135,
               0.449665,
               1.099591,
               -0.314915,
               -0.433248,
               -1.51002,
               -2.825565,
               -0.709136,
               0.22957,
               -0.60729,
               0.635989,
               -1.032047,
               0.032745,
               1.392744,
               -0.133622,
               0.692369,
               -0.420028,
               -0.483128,
               1.624416,
               1.951544,
               0.33301,
               -0.215358,
               -0.028016,
               -3.021593,
               0.119477,
               -0.560832,
               -0.293329,
               -2.270134,
               0.576507,
               -0.956194,
               0.948911,
               0.251268,
               1.487315,
               -1.638263,
               0.357951,
               -0.413316,
               0.714832,
               -0.739905,
               -0.153973,
               -1.176242,
               0.170329,
               -0.434688,
               0.747862,
               0.120337,
               -0.481574,
               1.136657),

          LIST(-0.593591,
               1.859548,
               0.249161,
               0.676157,
               0.859662,
               0.392747,
               -2.837827,
               -1.161998,
               -0.213121,
               -0.398741,
               0.893462,
               -2.473034,
               1.369548,
               -0.816652,
               0.446606,
               -1.168457,
               -0.935529,
               -1.044749,
               0.035797,
               -0.484173,
               0.566315,
               1.794253,
               -0.248206,
               0.34702,
               -0.425677,
               -0.249695,
               -0.51747,
               -1.522292,
               -1.600277,
               0.010729,
               0.760091,
               -0.080101,
               -0.477076,
               -1.59898,
               1.168583,
               0.002085,
               0.870672,
               -0.125717,
               0.559368,
               -0.60516,
               -0.344497,
               1.16437,
               -0.333677,
               0.507007,
               0.595549,
               -1.83513,
               -0.225581,
               -0.35965,
               0.774579,
               -0.877114,
               0.700943,
               1.086502,
               -0.342075,
               -1.543626,
               -1.342155,
               0.446591,
               0.216291,
               -1.071532,
               -0.509154,
               0.040005,
               0.322026,
               -0.296395,
               0.646083,
               0.320446,
               0.33697,
               1.80367,
               -0.158532,
               1.319875,
               -1.290043,
               -0.661309,
               1.088699,
               0.285606,
               -1.988428,
               -0.39131,
               1.31822,
               1.266902,
               -0.317389,
               1.194729,
               1.98206,
               -0.706244,
               1.566435,
               1.419536,
               -0.577035,
               -2.038813,
               0.437548,
               -0.442533,
               -0.484523,
               0.44865,
               -0.592259,
               0.987489,
               0.368031,
               -1.446288,
               -0.808057,
               0.428636,
               0.667097,
               0.505889,
               1.299293,
               1.374393,
               0.661116,
               0.306355,
               -1.032111,
               0.255774,
               -3.257905,
               -0.065164,
               -1.712093,
               -2.218556,
               -0.735969,
               -0.926222,
               -0.416535,
               -1.605775,
               0.461626,
               0.444886,
               0.994124,
               0.376888,
               -0.752383,
               -1.579577,
               1.539094,
               -1.349447,
               -0.906688,
               -0.215624,
               0.251347,
               0.723296,
               0.122108,
               0.295733,
               -0.045741,
               -0.580241,
               0.331587,
               1.082048),

          LIST(0.473876,
               0.230664,
               0.267298,
               0.103135,
               0.181214,
               0.406048,
               1.259755,
               -1.185046,
               -2.166379,
               -1.596702,
               -0.39181,
               1.1437,
               0.135151,
               -0.741832,
               -0.111727,
               -1.806395,
               -1.925569,
               -0.573528,
               -2.421664,
               0.155526,
               -0.865253,
               -0.72568,
               0.263178,
               0.377773,
               0.443862,
               -0.076033,
               1.137767,
               -0.515984,
               -0.209694,
               0.386404,
               -1.168237,
               0.796385,
               -0.922321,
               -0.221558,
               0.614164,
               -0.040158,
               -1.211582,
               -0.068861,
               1.510065,
               -0.926674,
               1.26152,
               -0.99538,
               -0.260887,
               0.475657,
               -0.580918,
               0.0006,
               0.125315,
               0.740747,
               0.277934,
               0.00975,
               0.107055,
               -0.581133,
               -1.070566,
               1.037663,
               0.373189,
               1.304875,
               -1.025931,
               1.433475,
               -0.976563,
               1.991798,
               0.038781,
               0.384018,
               0.806663,
               -0.776948),
          LIST(),

          LIST(-0.353709,
               -0.074231,
               0.105958,
               0.103361,
               -0.874412,
               -0.130653,
               0.293177,
               -0.202215,
               -0.746648,
               0.078181,
               -0.408272,
               0.308451,
               -0.288986,
               -0.035773,
               0.206605,
               -0.101585,
               -0.365228,
               0.031298,
               -0.007984,
               0.213135,
               -0.3253,
               -0.15034,
               0.222089,
               -0.274706,
               -0.381302,
               0.129838,
               0.161698,
               0.361009,
               -0.360315,
               -0.084764,
               0.303783,
               -0.06805,
               -0.341233,
               -0.016025,
               0.158206,
               0.319436,
               -0.579598,
               -0.386254,
               -0.156038,
               0.397128,
               -0.583619,
               -0.070997,
               0.202518,
               0.151165,
               -0.177376,
               -0.032747,
               0.088899,
               0.083503,
               -0.198178,
               -0.222517,
               0.081854,
               0.001791,
               -0.448159,
               -0.049159,
               0.142549,
               0.07363,
               -0.660492,
               0.285086,
               0.114371,
               0.516486,
               -0.823223,
               -0.238146,
               0.166327,
               0.071748,
               -0.153953,
               -0.051779,
               0.182246,
               -0.014829,
               -0.480805,
               0.189843,
               0.295622,
               0.262282,
               -0.4639,
               0.091838,
               0.303309,
               -0.139876,
               -0.464483,
               -0.144721,
               0.21283,
               -0.309852,
               -0.127137,
               0.042333,
               0.075449,
               0.220707,
               -1.126201,
               -0.207343,
               -0.250491,
               -0.134581,
               -0.386199,
               -0.113373,
               0.007587,
               0.054589,
               -0.359018,
               0.122456,
               0.324269,
               0.107375,
               -0.648241,
               0.010124,
               0.097738,
               0.055944,
               -0.808398,
               -0.178982,
               0.183889,
               -0.091267,
               -0.446793,
               -0.004204,
               0.138438,
               0.011394,
               -0.914105,
               0.417448,
               0.214762,
               0.633307,
               -0.624983,
               -0.295893,
               0.002612,
               0.259261,
               -0.854049,
               0.581066,
               0.092587,
               0.670907,
               -0.139566,
               0.074441,
               0.275647,
               -0.216602,
               -0.680033,
               -0.03244,
               -0.118288,
               0.348928),
          "test_case_0");