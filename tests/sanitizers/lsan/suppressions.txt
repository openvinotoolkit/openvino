# Copyright (C) 2018-2025 Intel Corporation
# SPDX-License-Identifier: Apache-2.0

# This is a LeakSanitizer (LSan) suppression file which provides a default
# configuration for the builds with -DENABLE_SANITIZER=ON.
# More information about LSan suppressions on
# https://github.com/google/sanitizers/wiki/AddressSanitizerLeakSanitizer#suppressions

# Noisy indirect leaks from pthread. TODO: investigate.
leak:__pthread_once_slow

# memory leaks in graphics driver
leak:libigdrcl.so

# leaks in std
leak:libstdc++
leak:libstdc
leak:libc
leak:libc++

# leaks from python packages used by tests
leak:site-packages/scipy/
leak:site-packages/tensorflow/
leak:site-packages/onnx/
leak:site-packages/mxnet/

# leaks from mostly tensorflow when used by tests
leak:_PyObject_New
leak:_PyLong_New
leak:PyCode_NewWithPosOnlyArgs
leak:PyLong_FromLongLong

# Noisy leaks from pybind11. TODO: investigate.
leak:pybind11

# leak reported if you run through `bash -c`
leak:/bin/bash

# leak reported by E2E tests
leak:libfontconfig.so

# leak reported from python wrappers of 3rd parties 
leak:_pywrap_tensorflow_internal.so
leak:site-packages/google/protobuf

# leaks from thirdparty libs
leak:thirdparty/protobuf
leak:thirdparty/protobuf/protobuf
leak:thirdparty/gtest
leak:thirdparty/tbb
leak:libtbb.so

#         # ???
# leak:pybind11::detail::
# # leak:_PyObject_Malloc
# # leak:malloc
# # leak:__interceptor_malloc
# leak:PyDict_Copy
# # leak:python3.11
# # leak:_PyObject_*

# # подавить внутренние аллокации CPython
# leak:PyMem_RawMalloc
# leak:PyMem_Malloc
# # leak:PyObject_Malloc
# leak:PyMem_RawFree
# leak:PyMem_Free
# # leak:PyObject_Free

# # опционально — pybind11 glue code
# leak:pybind11::detail::

# подавить мусорные аллокации CPython init
leak:Py_Initialize
leak:Py_Finalize
leak:PyEval_EvalFrameDefault

# подавить pybind11 glue
leak:pybind11::detail::